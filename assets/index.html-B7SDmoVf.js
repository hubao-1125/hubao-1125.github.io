import{_ as a,c as e,a as o,o as r}from"./app-Dm747Kgg.js";const n={};function s(i,t){return r(),e("div",null,t[0]||(t[0]=[o('<p>在JVM（Java虚拟机）的内存模型中，内存空间主要分为<strong>堆内存（Heap）<strong>和</strong>非堆内存（Non-Heap）<strong>两大部分。非堆内存是指堆以外的内存区域，主要用于存储与Java程序运行时直接相关但</strong>不属于对象实例</strong>的数据。</p><h3 id="一、非堆内存的核心组成" tabindex="-1"><a class="header-anchor" href="#一、非堆内存的核心组成"><span>一、非堆内存的核心组成</span></a></h3><p>根据JVM规范和HotSpot虚拟机的实现，非堆内存主要包含以下区域：</p><h4 id="_1-方法区-method-area" tabindex="-1"><a class="header-anchor" href="#_1-方法区-method-area"><span>1. 方法区（Method Area）</span></a></h4><ul><li><strong>作用</strong>：存储类的元数据（Class Metadata），包括类的结构信息（字段、方法、接口）、常量池、静态变量、即时编译器编译后的代码等。</li><li><strong>版本差异</strong>： <ul><li>JDK 7及之前：通过<strong>永久代（PermGen）</strong> 实现，属于非堆内存，大小受JVM控制。</li><li>JDK 8及之后：通过<strong>元空间（Metaspace）<strong>实现，使用</strong>操作系统本地内存</strong>（不再占用JVM内存），但概念上仍属于非堆。</li></ul></li></ul><h4 id="_2-虚拟机栈-jvm-stack" tabindex="-1"><a class="header-anchor" href="#_2-虚拟机栈-jvm-stack"><span>2. 虚拟机栈（JVM Stack）</span></a></h4><ul><li><strong>作用</strong>：每个线程私有，用于存储线程执行时的<strong>栈帧</strong>（Stack Frame）。栈帧包含局部变量表、操作数栈、方法出口等信息，是方法调用和执行的基础。</li><li><strong>特点</strong>：线程隔离，随线程创建而分配，线程结束而回收；大小可通过<code>-Xss</code>参数调整（默认约1MB）。</li></ul><h4 id="_3-本地方法栈-native-method-stack" tabindex="-1"><a class="header-anchor" href="#_3-本地方法栈-native-method-stack"><span>3. 本地方法栈（Native Method Stack）</span></a></h4><ul><li><strong>作用</strong>：类似虚拟机栈，但专门为<strong>Native方法</strong>（使用C/C++实现的方法，如<code>System.currentTimeMillis()</code>）服务。</li><li><strong>特点</strong>：线程私有，具体实现依赖于虚拟机（如HotSpot将其与虚拟机栈合并）。</li></ul><h4 id="_4-程序计数器-program-counter-register" tabindex="-1"><a class="header-anchor" href="#_4-程序计数器-program-counter-register"><span>4. 程序计数器（Program Counter Register）</span></a></h4><ul><li><strong>作用</strong>：每个线程私有，记录当前线程执行的<strong>字节码行号</strong>，是JVM中唯一不会发生内存溢出（OOM）的区域。</li><li><strong>特点</strong>：线程隔离，随线程创建而分配，用于线程上下文切换时恢复执行位置。</li></ul><h3 id="二、非堆内存的特点" tabindex="-1"><a class="header-anchor" href="#二、非堆内存的特点"><span>二、非堆内存的特点</span></a></h3><ol><li><strong>线程隔离性</strong>：虚拟机栈、本地方法栈、程序计数器是<strong>线程私有的</strong>，每个线程有独立的内存空间，互不影响。</li><li><strong>内存管理方式</strong>： <ul><li>虚拟机栈、本地方法栈、程序计数器：内存分配和回收<strong>自动进行</strong>（随线程生命周期），无需GC介入。</li><li>方法区（元空间）：需要GC回收，但条件严格（如类卸载），且回收频率低于堆内存。</li></ul></li><li><strong>大小限制</strong>： <ul><li>元空间：默认受系统可用内存限制（可通过<code>-XX:MaxMetaspaceSize</code>手动限制）。</li><li>虚拟机栈：单线程栈大小通过<code>-Xss</code>限制（总大小=线程数×单线程栈大小）。</li><li>程序计数器：内存占用极小，可忽略。</li></ul></li></ol><h3 id="三、非堆内存与堆内存的区别" tabindex="-1"><a class="header-anchor" href="#三、非堆内存与堆内存的区别"><span>三、非堆内存与堆内存的区别</span></a></h3><table><thead><tr><th>特性</th><th>堆内存（Heap）</th><th>非堆内存（Non-Heap）</th></tr></thead><tbody><tr><td>存储内容</td><td>对象实例（如<code>new Object()</code>）</td><td>类元数据、栈帧、常量池等</td></tr><tr><td>线程共享</td><td>是（所有线程共享堆空间）</td><td>部分共享（方法区），部分私有（虚拟机栈、本地方法栈、程序计数器）</td></tr><tr><td>垃圾回收</td><td>主要回收区域（Young GC、Old GC、Full GC）</td><td>仅方法区需要GC（类卸载），其他区域自动回收</td></tr><tr><td>内存来源</td><td>JVM管理的内存</td><td>部分来自JVM内存（虚拟机栈等），部分来自本地内存（元空间）</td></tr><tr><td>OOM风险</td><td><code>java.lang.OutOfMemoryError: Java heap space</code></td><td>元空间：<code>java.lang.OutOfMemoryError: Metaspace</code><br>虚拟机栈：<code>java.lang.StackOverflowError</code>或OOM</td></tr></tbody></table><h3 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h3><p>非堆内存是JVM运行时的<strong>基础设施内存</strong>，支撑类加载、方法执行、线程管理等核心功能。它与堆内存分工明确：堆内存负责存储对象实例，非堆内存负责存储类结构、线程执行状态等“支撑性”数据，共同构成了JVM完整的内存模型。</p>',17)]))}const l=a(n,[["render",s],["__file","index.html.vue"]]),c=JSON.parse(`{"path":"/doc/Java/JVM/%E5%88%86%E4%BB%A3%E5%88%86%E5%8C%BA/141820/","title":"什么是非堆内存","lang":"zh-CN","frontmatter":{"title":"什么是非堆内存","createTime":"2025/12/23 14:18:20","permalink":"/doc/Java/JVM/分代分区/141820/","copyright":{"author":{"name":"Hu Bao","url":"https://github.com/hubao-1125"}},"tags":["JVM","面试题"],"description":"在JVM（Java虚拟机）的内存模型中，内存空间主要分为堆内存（Heap）和非堆内存（Non-Heap）两大部分。非堆内存是指堆以外的内存区域，主要用于存储与Java程序运行时直接相关但不属于对象实例的数据。 一、非堆内存的核心组成 根据JVM规范和HotSpot虚拟机的实现，非堆内存主要包含以下区域： 1. 方法区（Method Area） 作用：存...","head":[["meta",{"property":"og:url","content":"https://hubao-1125.github.io/doc/Java/JVM/%E5%88%86%E4%BB%A3%E5%88%86%E5%8C%BA/141820/"}],["meta",{"property":"og:site_name","content":"Hu bao's blog"}],["meta",{"property":"og:title","content":"什么是非堆内存"}],["meta",{"property":"og:description","content":"在JVM（Java虚拟机）的内存模型中，内存空间主要分为堆内存（Heap）和非堆内存（Non-Heap）两大部分。非堆内存是指堆以外的内存区域，主要用于存储与Java程序运行时直接相关但不属于对象实例的数据。 一、非堆内存的核心组成 根据JVM规范和HotSpot虚拟机的实现，非堆内存主要包含以下区域： 1. 方法区（Method Area） 作用：存..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-12-23T06:34:42.000Z"}],["meta",{"property":"article:tag","content":"JVM"}],["meta",{"property":"article:tag","content":"面试题"}],["meta",{"property":"article:modified_time","content":"2025-12-23T06:34:42.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"什么是非堆内存\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-12-23T06:34:42.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":3.19,"words":957},"git":{"updatedTime":1766471682000,"contributors":[{"name":"hubao-1125","username":"hubao-1125","email":"19473254+hubao-1125@users.noreply.github.com","commits":1,"avatar":"https://avatars.githubusercontent.com/hubao-1125?v=4","url":"https://github.com/hubao-1125"}]},"autoDesc":true,"filePathRelative":"doc/Java/JVM/分代分区/7.什么是非堆内存.md","categoryList":[{"id":"9a09b4","sort":10000,"name":"doc"},{"id":"8f1aa6","sort":10001,"name":"Java"},{"id":"000f90","sort":10002,"name":"JVM"},{"id":"2b6b47","sort":10003,"name":"分代分区"}]}`);export{l as comp,c as data};
