import{_ as a,c as p,f as n,o as c}from"./app-DAa-7Y-M.js";const l={};function e(o,s){return c(),p("div",null,s[0]||(s[0]=[n(`<p>最近在跟前端联调的时候，发现个问题，<code>Java</code>后端返回给前端的参数，如果是<code>Long</code>的话，前端接收的时候，会出现精度丢失的情况。</p><p>前端让返回<code>String</code>。由于项目是使用的<code>fastjson</code>，于是用了<code>fastjson</code>的<code>@JSONField(serializeUsing = ToStringSerializer.class)</code>注解。</p><p>发现不起作用。查阅资料后才知道。<code>SpringBoot</code>的<code>Json</code>序列化默认是<code>Jackson</code>。于是，就把<code>SpringBoot</code>的默认序列化给修改了，代码如下：</p><div class="language-java line-numbers-mode has-collapsed collapsed" data-ext="java" data-title="java" style="--vp-collapsed-lines:50;"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki material-theme-ocean vp-code"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#C792EA;">public</span><span class="space"> </span><span style="color:#C792EA;">void</span><span class="space"> </span><span style="color:#82AAFF;">configureMessageConverters</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">HttpMessageConverter</span><span style="color:#89DDFF;">&lt;</span><span style="color:#89DDFF;font-style:italic;">?</span><span style="color:#89DDFF;">&gt;&gt;</span><span class="space"> </span><span style="color:#BABED8;">converters</span><span style="color:#89DDFF;">)</span><span class="space"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">converters</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span class="space"> </span><span style="color:#82AAFF;">ByteArrayHttpMessageConverter</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">converters</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span class="space"> </span><span style="color:#82AAFF;">StringHttpMessageConverter</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">StandardCharsets</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">UTF_8</span><span style="color:#89DDFF;">));</span><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">@ResponseBody</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">解决乱码</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">converters</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span class="space"> </span><span style="color:#82AAFF;">ResourceHttpMessageConverter</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">converters</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;font-style:italic;">new</span><span class="space"> </span><span style="color:#82AAFF;">AllEncompassingFormHttpMessageConverter</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">converters</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">fastJsonHttpMessageConverter</span><span style="color:#89DDFF;">());</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Bean</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#C792EA;">public</span><span class="space"> </span><span style="color:#C792EA;">FastJsonHttpMessageConverter</span><span class="space"> </span><span style="color:#82AAFF;">fastJsonHttpMessageConverter</span><span style="color:#89DDFF;">()</span><span class="space"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#C792EA;">FastJsonHttpMessageConverter</span><span class="space"> </span><span style="color:#BABED8;">converter</span><span class="space"> </span><span style="color:#89DDFF;">=</span><span class="space"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span class="space"> </span><span style="color:#82AAFF;">FastJsonHttpMessageConverter</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#C792EA;">FastJsonConfig</span><span class="space"> </span><span style="color:#BABED8;">config</span><span class="space"> </span><span style="color:#89DDFF;">=</span><span class="space"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span class="space"> </span><span style="color:#82AAFF;">FastJsonConfig</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">//Long类型转String类型</span></span>
<span class="line"><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">SerializeConfig</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">serializeConfig</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">=</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">SerializeConfig.globalInstance;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">ToStringSerializer</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">是这个包</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">com.alibaba.fastjson.serializer.ToStringSerializer</span></span>
<span class="line"><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">serializeConfig.put(BigInteger.class,</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">ToStringSerializer.instance);</span></span>
<span class="line"><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">serializeConfig.put(Long.class,</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">ToStringSerializer.instance);</span></span>
<span class="line"><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">serializeConfig.put(Long.TYPE,</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">ToStringSerializer.instance);</span></span>
<span class="line"><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">config.setSerializeConfig(serializeConfig);</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setSerializerFeatures</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">SerializerFeature</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">WriteMapNullValue</span><span style="color:#89DDFF;">,</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">保留map空的字段</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">SerializerFeature</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">WriteNullStringAsEmpty</span><span style="color:#89DDFF;">,</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">将String类型的null转成&quot;&quot;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">SerializerFeature</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">WriteNullNumberAsZero</span><span style="color:#89DDFF;">,</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">将Number类型的null转成0</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">SerializerFeature</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">WriteNullListAsEmpty</span><span style="color:#89DDFF;">,</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">将List类型的null转成[]</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">SerializerFeature</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">WriteNullBooleanAsFalse</span><span style="color:#89DDFF;">,</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">将Boolean类型的null转成false</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">SerializerFeature</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">WriteDateUseDateFormat</span><span style="color:#89DDFF;">,</span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">//日期格式转换</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">SerializerFeature</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">DisableCircularReferenceDetect</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">避免循环引用</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">config</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setSerializeFilters</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">valueFilter</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">converter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setFastJsonConfig</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">config</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">converter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setDefaultCharset</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">StandardCharsets</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">UTF_8</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">//</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">解决中文乱码问题，相当于在Controller上的@RequestMapping中加了个属性produces</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">=</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">&quot;application/json&quot;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#C792EA;">List</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C792EA;">MediaType</span><span style="color:#89DDFF;">&gt;</span><span class="space"> </span><span style="color:#BABED8;">mediaTypeList</span><span class="space"> </span><span style="color:#89DDFF;">=</span><span class="space"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span class="space"> </span><span style="color:#C792EA;">ArrayList</span><span style="color:#89DDFF;">&lt;&gt;();</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">mediaTypeList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">MediaType</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">APPLICATION_JSON</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#BABED8;">converter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setSupportedMediaTypes</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">mediaTypeList</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#89DDFF;font-style:italic;">return</span><span class="space"> </span><span style="color:#BABED8;">converter</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">/**</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">*</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">FastJson过滤器将null值转换为字符串</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">*</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">obj</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">是class</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">*</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">s</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">是key值</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">*</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">o1</span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">是value值</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#464B5D;font-style:italic;">*/</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#C792EA;">public</span><span class="space"> </span><span style="color:#C792EA;">static</span><span class="space"> </span><span style="color:#C792EA;">final</span><span class="space"> </span><span style="color:#C792EA;">ValueFilter</span><span class="space"> </span><span style="color:#BABED8;">valueFilter</span><span class="space"> </span><span style="color:#89DDFF;">=</span><span class="space"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">obj</span><span style="color:#89DDFF;">,</span><span class="space"> </span><span style="color:#BABED8;">s</span><span style="color:#89DDFF;">,</span><span class="space"> </span><span style="color:#BABED8;">v</span><span style="color:#89DDFF;">)</span><span class="space"> </span><span style="color:#C792EA;">-&gt;</span><span class="space"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span class="space"> </span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">v</span><span class="space"> </span><span style="color:#89DDFF;">==</span><span class="space"> </span><span style="color:#89DDFF;">null)</span><span class="space"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#89DDFF;font-style:italic;">return</span><span class="space"> </span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#89DDFF;font-style:italic;">return</span><span class="space"> </span><span style="color:#BABED8;">v</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="color:#89DDFF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>上面的代码有部分注释掉的情况，那个如果不注释掉，所有接口返回的<code>Long</code>类型都会变成<code>String</code>。到这儿，本来为问题解决了。可谁知道前几天突然有个同事说支付不好使了。于是就去看啥问题。我返回的字段是这样的<code>aLiPayStr</code>。前端同学接收的是<code>aliPayStr</code>。于是，主观意识告诉我，前端同学错了。我就告诉他们别乱改接收返回字段，前端同学也很委屈，我没有改，<code>git</code>提交记录显示代码压根没动过。</p><p>于是，我就犯嘀咕了，接口出参没动过，我的<code>git</code>提交记录也显示好久没修改了，前端也是，那么到底哪出了问题呢。而且就测试环境有问题，别的环境好好的，我就去仔细过了一下我的代码。发现有上面代码的合并记录。翻阅相关资料，发现了<code>Jackson</code>的一个奇葩的地方，也是个坑，告诉大家，不要踩坑。<code>SpringBoot</code>的默认<code>Json</code>序列化<code>Jackson</code>在对参数返回的时候，会对字段属性头两个字母做小写处理。。。</p><p>我惊呆了，你这玩意儿写的咋这么反人类，因为我把默认<code>Json</code>序列化给修改成阿里的<code>fastjson</code>。于是问题就出现了，阿里的<code>fastjson</code>是你的字段属性是啥，人家就给你返回啥，而不是把你的字段属性的前两个字母给变成小写。以前返回的一直是<code>aliPayStr</code>，换成<code>fastjson</code>后，就变成了跟我字段属性写的一样<code>aLiPayStr</code>。</p><p>于是，代码回滚。但是，代码回滚的话<code>Long</code>转<code>String</code>咋整。</p><p>嗯，用了<code>Jackson</code>的<code>@JsonSerialize(using = ToStringSerializer.class)</code>注解就解决了问题。</p><p>其实，写到这里，大家可能觉得无所谓，但是吧，我们平时开发总是会犯一个主观性的错误，就是我用了啥，返回的就是啥，其实不是。用什么框架，不能说原理全部了解，但是，一些小细节还是需要知道的。不然就会向我一样犯错误。</p><p>嗯，写完了，拜拜~</p>`,11)]))}const i=a(l,[["render",e],["__file","index.html.vue"]]),r=JSON.parse(`{"path":"/doc/Java/Spring/SpringBoot/185312/","title":"SpringBoot的Json序列化与FastJson序列化","lang":"zh-CN","frontmatter":{"title":"SpringBoot的Json序列化与FastJson序列化","createTime":"2025/01/30 18:53:12","permalink":"/doc/Java/Spring/SpringBoot/185312/","copyright":{"author":{"name":"Hu Bao","url":"https://github.com/hubao-1125"}},"tags":["Java","SpringBoot"],"description":"最近在跟前端联调的时候，发现个问题，Java后端返回给前端的参数，如果是Long的话，前端接收的时候，会出现精度丢失的情况。 前端让返回String。由于项目是使用的fastjson，于是用了fastjson的@JSONField(serializeUsing = ToStringSerializer.class)注解。 发现不起作用。查阅资料后才知道...","head":[["meta",{"property":"og:url","content":"https://hubao-1125.github.io/doc/Java/Spring/SpringBoot/185312/"}],["meta",{"property":"og:site_name","content":"Hu bao's blog"}],["meta",{"property":"og:title","content":"SpringBoot的Json序列化与FastJson序列化"}],["meta",{"property":"og:description","content":"最近在跟前端联调的时候，发现个问题，Java后端返回给前端的参数，如果是Long的话，前端接收的时候，会出现精度丢失的情况。 前端让返回String。由于项目是使用的fastjson，于是用了fastjson的@JSONField(serializeUsing = ToStringSerializer.class)注解。 发现不起作用。查阅资料后才知道..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-30T11:07:46.000Z"}],["meta",{"property":"article:tag","content":"Java"}],["meta",{"property":"article:tag","content":"SpringBoot"}],["meta",{"property":"article:modified_time","content":"2025-01-30T11:07:46.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SpringBoot的Json序列化与FastJson序列化\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-01-30T11:07:46.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":3.07,"words":922},"git":{"updatedTime":1738235266000,"contributors":[{"name":"hubao-1125","username":"hubao-1125","email":"19473254+hubao-1125@users.noreply.github.com","commits":4,"avatar":"https://avatars.githubusercontent.com/hubao-1125?v=4","url":"https://github.com/hubao-1125"}]},"autoDesc":true,"filePathRelative":"doc/Java/Spring/SpringBoot/SpringBoot的Json序列化与FastJson序列化.md","categoryList":[{"id":"9a09b4","sort":10000,"name":"doc"},{"id":"8f1aa6","sort":10001,"name":"Java"},{"id":"090c29","sort":10024,"name":"Spring"},{"id":"fe21ab","sort":10025,"name":"SpringBoot"}]}`);export{i as comp,r as data};
